<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SM VOICE â€“ True ChatGPT Female Voice</title>

<style>
:root{
  --bg:#020617;--panel:#0f172a;--user:#2563eb;
  --ai:#1e293b;--text:#e5e7eb
}
*{box-sizing:border-box;font-family:system-ui}
body{
  margin:0;height:100vh;background:radial-gradient(circle,#0b1020,#020617);
  color:var(--text);display:flex;flex-direction:column
}
.header{
  padding:14px;text-align:center;font-weight:700;
  border-bottom:1px solid #1e293b
}
.chat{
  flex:1;padding:16px;overflow-y:auto;
  display:flex;flex-direction:column;gap:14px
}
.bubble{
  max-width:85%;padding:14px 16px;border-radius:22px;
  animation:fade .2s ease
}
.user{background:#2563eb;align-self:flex-end}
.ai{background:#1e293b;align-self:flex-start}
.footer{
  padding:20px;display:flex;justify-content:center;
  border-top:1px solid #1e293b
}
.voice{
  width:120px;height:120px;border-radius:50%;
  background:radial-gradient(circle,#22c55e,#064e3b);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 40px rgba(34,197,94,.6)
}
.voice.listening{
  background:radial-gradient(circle,#ef4444,#7f1d1d);
  box-shadow:0 0 45px rgba(239,68,68,.8)
}
.wave{display:flex;gap:6px}
.wave span{
  width:7px;height:26px;background:#e5e7eb;
  border-radius:8px;animation:wave 1.1s infinite ease-in-out
}
.wave span:nth-child(2){animation-delay:.1s}
.wave span:nth-child(3){animation-delay:.2s}
.wave span:nth-child(4){animation-delay:.3s}
.wave span:nth-child(5){animation-delay:.4s}
@keyframes wave{0%,100%{height:18px}50%{height:42px}}
@keyframes fade{from{opacity:0;transform:translateY(6px)}to{opacity:1}}
</style>
</head>

<body>

<div class="header">ðŸŽ§ SM VOICE â€“ True ChatGPT (Female)</div>

<div id="chat" class="chat">
  <div class="bubble ai">Iâ€™m ready. Speak now.</div>
</div>

<div class="footer">
  <div id="voice" class="voice">
    <div class="wave">
      <span></span><span></span><span></span><span></span><span></span>
    </div>
  </div>
</div>

<script>
/* ðŸ”‘ CHANGE ONLY THIS */
const WORKER_URL = "https://YOUR-WORKER-URL.workers.dev";

/* ELEMENTS */
const chat = document.getElementById("chat");
const voiceUI = document.getElementById("voice");

/* SPEECH RECOGNITION */
const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
const recognition = new SR();
recognition.lang = "en-US";
recognition.interimResults = false;
recognition.continuous = false;

let speaking = false;
let femaleVoice = null;

/* ðŸŽ¤ MIC UI */
recognition.onstart = ()=> voiceUI.classList.add("listening");
recognition.onend = ()=> voiceUI.classList.remove("listening");

/* USER SPEECH */
recognition.onresult = e=>{
  const text = e.results[0][0].transcript;
  add(text,"user");
  askChatGPT(text);
};

/* ADD CHAT */
function add(text,type){
  const d=document.createElement("div");
  d.className="bubble "+type;
  d.textContent=text;
  chat.appendChild(d);
  chat.scrollTop=chat.scrollHeight;
}

/* ðŸ‘© FORCE FEMALE VOICE */
function loadFemaleVoice(){
  const v = speechSynthesis.getVoices();
  const lang = recognition.lang.split("-")[0];

  femaleVoice =
    v.find(x =>
      /female|zira|susan|neural|google/i.test(x.name) &&
      x.lang.startsWith(lang)
    ) ||
    v.find(x =>
      x.lang.startsWith(lang) &&
      !/male/i.test(x.name)
    ) ||
    v[0];
}

speechSynthesis.onvoiceschanged = loadFemaleVoice;
loadFemaleVoice();

/* ðŸ”Š SPEAK (NO MIC OVERLAP) */
function speak(text){
  speaking = true;
  speechSynthesis.cancel();
  recognition.abort();

  const u = new SpeechSynthesisUtterance(text);
  u.lang = recognition.lang;
  if(femaleVoice) u.voice = femaleVoice;

  u.rate = 0.95;
  u.pitch = 1.15; // ðŸ‘© female natural
  u.volume = 1;

  u.onend = ()=>{
    speaking = false;
    setTimeout(()=>recognition.start(),800);
  };

  speechSynthesis.speak(u);
}

/* ðŸ§  CHATGPT REQUEST */
async function askChatGPT(q){
  speak("Thinking");

  try{
    const r = await fetch(WORKER_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({text:q})
    });

    const d = await r.json();
    const reply = d.reply || "No response";

    add(reply,"ai");
    speak(reply);

  }catch{
    add("Connection error","ai");
    speak("Connection error");
  }
}

/* â–¶ AUTO START */
setTimeout(()=>recognition.start(),1200);
</script>

</body>
</html>