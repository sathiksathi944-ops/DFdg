<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SM VOICE â€“ Stable Intelligent ChatGPT</title>

<style>
:root{
  --bg:#020617;--panel:#0f172a;--user:#2563eb;--ai:#1e293b;--text:#e5e7eb;
}
*{box-sizing:border-box;font-family:system-ui,-apple-system,"Segoe UI",sans-serif}
body{
  margin:0;height:100vh;
  background:radial-gradient(circle at top,#0b1020,#020617);
  color:var(--text);display:flex;flex-direction:column;
}
.header{padding:14px;text-align:center;font-weight:700;border-bottom:1px solid #1e293b}
select{
  margin-top:6px;padding:8px 12px;border-radius:10px;
  background:#020617;color:white;border:1px solid #334155;
}
.chat{
  flex:1;padding:16px;overflow-y:auto;
  display:flex;flex-direction:column;gap:14px;
}
.bubble{
  max-width:85%;padding:14px 16px;border-radius:22px;
  line-height:1.5;animation:fade .2s ease;
}
.user{background:linear-gradient(135deg,#2563eb,#1d4ed8);align-self:flex-end}
.ai{background:#1e293b;align-self:flex-start}
.footer{padding:22px;display:flex;justify-content:center;border-top:1px solid #1e293b}
.voice{
  width:120px;height:120px;border-radius:50%;
  background:radial-gradient(circle,#22c55e,#064e3b);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 0 40px rgba(34,197,94,.6);
}
.voice.listening{
  background:radial-gradient(circle,#ef4444,#7f1d1d);
  box-shadow:0 0 45px rgba(239,68,68,.8);
}
.wave{display:flex;gap:6px}
.wave span{
  width:7px;height:26px;background:#e5e7eb;border-radius:8px;
  animation:wave 1.2s infinite ease-in-out;
}
.wave span:nth-child(2){animation-delay:.1s}
.wave span:nth-child(3){animation-delay:.2s}
.wave span:nth-child(4){animation-delay:.3s}
.wave span:nth-child(5){animation-delay:.4s}
@keyframes wave{0%,100%{height:18px}50%{height:42px}}
@keyframes fade{from{opacity:0;transform:translateY(5px)}to{opacity:1}}
</style>
</head>

<body>

<div class="header">
ðŸŽ§ SM VOICE â€“ Stable Intelligent AI
<br>
<select id="lang">
  <option value="en-US">English</option>
  <option value="hi-IN">Hindi</option>
  <option value="ar-SA">Arabic</option>
</select>
</div>

<div id="chat" class="chat">
  <div class="bubble ai">
    Iâ€™m ready âœ…  
    I will keep listening continuously like ChatGPT.
  </div>
</div>

<div class="footer">
  <div id="voice" class="voice">
    <div class="wave"><span></span><span></span><span></span><span></span><span></span></div>
  </div>
</div>

<script>
const chat = document.getElementById("chat");
const voice = document.getElementById("voice");
const langSelect = document.getElementById("lang");

const SR = window.SpeechRecognition || window.webkitSpeechRecognition;
let recognition;
let listening = false;
let speaking = false;
let femaleVoice = null;

/* CREATE RECOGNITION SAFELY */
function createRecognition(){
  recognition = new SR();
  recognition.interimResults = false;
  recognition.continuous = false;

  recognition.onstart = ()=>{
    listening = true;
    voice.classList.add("listening");
  };

  recognition.onend = ()=>{
    listening = false;
    voice.classList.remove("listening");
    if(!speaking) safeRestart();
  };

  recognition.onerror = ()=>{
    listening = false;
    voice.classList.remove("listening");
    setTimeout(safeRestart,1000);
  };

  recognition.onresult = e=>{
    const text = e.results[0][0].transcript;
    add(text,"user");
    respond(text);
  };
}

/* SAFE RESTART */
function safeRestart(){
  if(speaking || listening) return;
  try{
    recognition.lang = langSelect.value;
    recognition.start();
  }catch(e){}
}

/* LOAD FEMALE VOICE */
function loadVoices(){
  const v = speechSynthesis.getVoices();
  const l = langSelect.value;
  femaleVoice =
    v.find(x=>x.lang===l && /female|zira|google|neural/i.test(x.name))
    || v.find(x=>x.lang===l)
    || v[0];
}
speechSynthesis.onvoiceschanged = loadVoices;
loadVoices();

/* ADD CHAT */
function add(t,c){
  const d=document.createElement("div");
  d.className="bubble "+c;
  d.textContent=t;
  chat.appendChild(d);
  chat.scrollTop=chat.scrollHeight;
}

/* SPEAK */
function speak(text){
  speaking = true;
  speechSynthesis.cancel();
  const u = new SpeechSynthesisUtterance(text);
  u.lang = langSelect.value;
  if(femaleVoice) u.voice = femaleVoice;
  u.rate = .95; u.pitch = 1.05;
  u.onend = ()=>{
    speaking = false;
    setTimeout(safeRestart,800);
  };
  speechSynthesis.speak(u);
}

/* INTELLIGENT RESPONSE */
async function respond(q){
  speak("Let me think");
  let answer = "";

  try{
    const r = await fetch(
      "https://en.wikipedia.org/api/rest_v1/page/summary/" +
      encodeURIComponent(q)
    );
    const d = await r.json();
    if(d.extract) answer = d.extract;
  }catch(e){}

  if(!answer) answer = "I understand your question. Please explain a little more.";

  add(answer,"ai");
  speak(answer.slice(0,160));
}

/* START */
createRecognition();
setTimeout(safeRestart,800);
</script>

</body>
</html>